{"ast":null,"code":"import _classCallCheck from \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/jeffrey/Bureau/cours/projet_de_d\\xE9partement/language-allocation/front/src/LoginPage.js\";\nimport React, { Component } from 'react';\nimport './LoginPage.css';\nimport axios from 'axios';\nimport url from \"./url\";\nimport queryString from 'query-string';\nimport { Cookies } from 'react-cookie';\nimport { Redirect } from 'react-router-dom';\n\nvar LoginPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(LoginPage, _Component);\n\n  function LoginPage(props) {\n    var _this;\n\n    _classCallCheck(this, LoginPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LoginPage).call(this, props));\n\n    _this.getState = function () {\n      return _this.state;\n    };\n\n    _this.onSubmit = function () {\n      _this.props.handlePageChange(\"questionnaire\"); //ajouter une requête\n\n    };\n\n    _this.handleInputChange = function (event) {\n      var target = event.target;\n      var value = target.value;\n      var name = target.name;\n      var new_state = _this.state;\n      new_state[name] = value;\n\n      _this.setState(new_state);\n    };\n\n    _this.state = {\n      token: null,\n      user_name: null,\n      user_email: null,\n      user_vows: null,\n      got_data: null\n    };\n    return _this;\n  }\n\n  _createClass(LoginPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var token = queryString.parse(this.props.location.search).token;\n      console.log(token);\n      axios.get(url + \"login/\" + token, {\n        withCredentials: false\n      }).then(function (result) {\n        var new_state = _this2.state;\n        window.sessionStorage.setItem(\"token\", token);\n        window.sessionStorage.setItem(\"name\", result.data.result.name);\n        window.sessionStorage.setItem(\"email\", result.data.result.email);\n        window.sessionStorage.setItem(\"vows\", result.data.result.vows);\n        new_state.got_data = true;\n\n        _this2.setState({\n          new_state: new_state\n        });\n\n        _this2.props.history.push('/form');\n      }, function (error) {\n        console.log(\"Error 404 : Invalid Token\");\n\n        _this2.props.history.push('/404');\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }, \"login...\");\n    }\n  }]);\n\n  return LoginPage;\n}(Component);\n\nexport default LoginPage;","map":{"version":3,"sources":["/home/jeffrey/Bureau/cours/projet_de_département/language-allocation/front/src/LoginPage.js"],"names":["React","Component","axios","url","queryString","Cookies","Redirect","LoginPage","props","getState","state","onSubmit","handlePageChange","handleInputChange","event","target","value","name","new_state","setState","token","user_name","user_email","user_vows","got_data","parse","location","search","console","log","get","withCredentials","then","result","window","sessionStorage","setItem","data","email","vows","history","push","error"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './LoginPage.css';\nimport axios from 'axios';\nimport url from \"./url\";\nimport queryString from 'query-string';\nimport {Cookies} from 'react-cookie';\nimport { Redirect } from 'react-router-dom'\n\n\nclass LoginPage extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {token:null, user_name:null, user_email:null, user_vows:null, got_data:null};\n      }\n    componentDidMount() {\n        const token = queryString.parse(this.props.location.search).token;\n        console.log(token)\n        axios.get(url+\"login/\"+token,{withCredentials:false})\n        .then(\n          (result) => {\n            let new_state=this.state;\n            window.sessionStorage.setItem(\"token\", token);\n            window.sessionStorage.setItem(\"name\", result.data.result.name)\n            window.sessionStorage.setItem(\"email\", result.data.result.email)\n            window.sessionStorage.setItem(\"vows\", result.data.result.vows)\n            new_state.got_data=true;\n            this.setState({\n              new_state\n            });\n            this.props.history.push('/form')\n          },\n          (error) => {\n            console.log(\"Error 404 : Invalid Token\");\n            this.props.history.push('/404')\n          }\n        );\n\n      }\n\n    getState=()=>{\n        return this.state;\n    }\n\n    onSubmit=()=>{\n        this.props.handlePageChange(\"questionnaire\");//ajouter une requête\n    }\n\n    handleInputChange=(event)=>{\n        const target = event.target;\n        const value =  target.value;\n        const name = target.name;\n\n        let new_state= this.state;\n        new_state[name]=value;\n        this.setState(new_state);\n    }\n\n    render() {\n      return(<div>login...</div>)\n    }\n  }\n\n\nexport default LoginPage;\n"]},"metadata":{},"sourceType":"module"}